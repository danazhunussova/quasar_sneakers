import{Q as _,_ as g}from"./QPage.1e0972c9.js";import{c}from"./QCard.387129e1.js";import{i as x,r as k,m as I,b as w,o as B,w as n,s as q,t as F,u as A,x as s,v as C}from"./index.d3544515.js";import"./vm.8d992f81.js";const Q={class:"flex justify-between items-center"},S=s("h4",{class:"text-bold"},"All Sneakers",-1),P={class:"flex q-gutter-md items-bottom"},T=s("option",{value:"name"},"\u041F\u043E \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u044E",-1),j=s("option",{value:"price"},"\u043F\u043E \u0446\u0435\u043D\u0435 (\u0434\u0435\u0448\u0435\u0432\u044B\u0435)",-1),N=s("option",{value:"-price"},"\u043F\u043E \u0446\u0435\u043D\u0435 (\u0434\u043E\u0440\u043E\u0433\u0438\u0435)",-1),V=[T,j,N],J=["src"],E={__name:"IndexPage",setup(M){const{mycart:l,addToCart:i,removeFromCart:u}=x("mycart"),t=k([]),v=e=>{o.sortBy=e.target.value},p=e=>{o.searchQuery=e.target.value,console.log(o.searchQuery)},h=async e=>{try{e.isAdded?u(e):i(e)}catch(a){console.log(a)}},o=I({sortBy:"",searchQuery:""}),y=async e=>{try{if(e.isFav)await c.delete("https://6e5e12b4bb07b2b5.mokky.dev/favs/"+e.favId),e.isFav=!1,e.favId=null;else{const a={itemId:e.id,item:e},{data:r}=await c.post("https://6e5e12b4bb07b2b5.mokky.dev/favs",a);e.isFav=!0,e.favId=data.id,console.log(data)}}catch(a){console.log(a)}},m=async()=>{try{const{data:e}=await c.get("https://6e5e12b4bb07b2b5.mokky.dev/favs");t.value=t.value.map(a=>{const r=e.find(b=>b.itemId===a.id);return r?{...a,isFav:!0,favId:r.id}:a})}catch(e){console.log(e)}},d=async()=>{try{const e={sortBy:o.sortBy,searchQuery:o.searchQuery},{data:a}=await c.get("https://6e5e12b4bb07b2b5.mokky.dev/items?sortBy="+o.sortBy+"&title=*"+o.searchQuery+"*");t.value=a.map(r=>({...r,isFav:!1,isAdded:!1,favId:null,cartIteId:null}))}catch(e){console.log(e)}},f=w(()=>"/quasar_sneakers");return B(async()=>{const e=localStorage.getItem("mycart");l.value=e?JSON.parse(e):[],await d(),await m(),t.value=t.value.map(a=>({...a,isAdded:l.value.some(r=>r.id===a.id)}))}),n(l,()=>{t.value=t.value.map(e=>({...e,isAdded:!1}))}),n(o,d),(e,a)=>(q(),F(_,{class:"q-mx-xl"},{default:A(()=>[s("div",Q,[S,s("div",P,[s("select",{onChange:v,class:"q-py-4 q-px-6",style:{"min-width":"200px",border:"0.5px solid grey","border-radius":"5px"}},V,32),s("div",null,[s("img",{class:"absolute q-mt-sm q-ml-xs",src:f.value+"/search.svg",alt:"Search"},null,8,J),s("input",{onChange:p,class:"border border-red q-py-xs q-pl-lg",placeholder:"\u041F\u043E\u0438\u0441\u043A",type:"text",style:{border:"0.5px solid grey","border-radius":"5px"}},null,32)])])]),C(g,{items:t.value,onAddToFav:y,onAddToCart:h},null,8,["items"])]),_:1}))}};export{E as default};
